<%= render 'layouts/navbar_weekly_schedule' %>
<!-- secondary navbar, schedule active -->

<div class="container text-center">
  <!-- timerange selector ( This Week - Next Week ) -->
  <div class="row mt-3">
    <div class="col-2"></div>
      <div class="col-8">
      <ul class="nav nav-pills justify-content-center" role="tablist" id="searchTab">
        <li class="nav-item">
          <a class="nav-link active" id="this-week-tab" href="#this-week" data-toggle="pill" role="tab" aria-controls="this-week" aria-selected="true">This Week</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" id="next-week-tab" href="#next-week" data-toggle="pill" role="tab" aria-controls="next-week" aria-selected="false">Next Week</a>
        </li>
      </ul>
    </div>
    <div class="col-2"></div>
  </div>
  <div class="tab-content clearfix">
    <div class="tab-pane active" id="this-week" role="tabpanel" aria-labelledby="this-week-tab">
      <% if @events.empty?  %>
        <div class="mt-3 mb-3">
          <h4> No classes this week </h4>
        </div>
      <% else %>
        <% $previous_date = 0 %>
        <% @events.each do |event| %>
          <% if event.date != @previous_date %>
            <div class="row">
              <div class="col-1"></div>
              <div class="col-10">
                <h4> <% event.date %> </h4>
              </div>
              <div class="col-1"></div>
            </div>
            <% @previous_date = event.date %>
          <% end %>
          <div class="row text-center">
            <div class="col-1"></div>
            <div class="col-10">
              <div class="row">
                <h5>
                  <div class="col-1"></div>
                  <div class="col-3"><% event.start_time %></div>
                  <div class="col-1"></div>
                  <div class="col-3"><% event.title %></div>
                  <div class="col-1"></div>
                  <div class="col-3"><% event.location %></div>
                </h5>
              </div>
            </div>
            <div class="col-1"></div>
          </div>
        <% end %>
      <% end %>
    </div>
    <div class="tab-pane" id="next-week" role="tabpanel" aria-labelledby="next-week-tab">
      <% if @events_next_week.empty?   %>
      <div class="mt-3 mb-3">
        <h4> No classes this week </h4>
      </div>
      <% else %>
        <% @events_next_week.each_with_index do |event, i| %>
          <% if event[i].date != event[i-1].date %>
            <div class="row">
              <div class="col-1"></div>
              <div class="col-10">
                <h4> <% event[i].date %> </h4>
              </div>
              <div class="col-1"></div>
            </div>
          <% end %>
          <div class="row text-center">
            <div class="col-1"></div>
            <div class="col-10">
              <div class="row">
                <h5>
                  <div class="col-1"></div>
                  <div class="col-3"><% event[i].start_time %></div>
                  <div class="col-1"></div>
                  <div class="col-3"><% event[i].title %></div>
                  <div class="col-1"></div>
                  <div class="col-3"><% event[i].location %></div>
                </h5>
              </div>
            </div>
            <div class="col-1"></div>
          </div>
        <% end %>
      <% end %>
    </div>
  </div>
  <!-- display timerange schedule -->

  <div class="row text-center mt-5 mb-3">
    <div class="col-2"></div>
    <div class="col-3">
      <% if current_user && current_user == @user %>
          <!-- change url below -->
        <p><%= link_to "Export", user_events_url(current_user), class:'btn btn-outline-primary round-btn' %></p>
      <% end %>
    </div>
    <div class="col-2"></div>
    <div class="col-3">
      <% if current_user && current_user == @user %>
          <!-- change url below -->
        <%= link_to "Edit Schedule", user_events_url(current_user), class:'btn btn-primary round-btn' %>
      <% end %>
    </div>
    <div class="col-2"></div>
</div>


<% if current_user && current_user.role == 1 %>
	<%= render 'layouts/footer_trainer' %>
<% else %>
	<%= render 'layouts/footer_trainee' %>
<% end %>
